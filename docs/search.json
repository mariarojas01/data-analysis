[
  {
    "objectID": "Handout.html#assupmtions",
    "href": "Handout.html#assupmtions",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "1.1 Assupmtions",
    "text": "1.1 Assupmtions\nAccording to Ernst and Albers (2017) there are 4 assupmtions in the linear regression model, violating these assumptions can create several kinds of problems. First, the resulting estimates may be biased, meaning they do not,reflect the true population values. Second, the estimators might become inconsistent, so increasing the sample size no longer estimates will approach the true parameters. Third, may lose its efficiency, meaning it can yield less precise estimates. Fourth, hypothesis tests and confidence intervals may become unreliable. Note that these assumptions specifically apply to estimation using the Ordinary Least Squares (OLS) method (a statistical method used to estimate the parameters of a linear regression model by minimizing the sum of the squared differences between the observed and predicted values), which is the default in many statistical software programs.\n\nLinearity: The model assumes a linear and additive relationship between each predictor and the mean of the dependent variable, with errors averaging zero for any combination of predictors. Problems arise if relationships are nonlinear or if measurement error is present. Multicollinearity is not an assumption, but low overlap between predictors is desirable. (Ernst & Albers, 2017)\nNormality: The model errors are assumed to follow a normal distribution centered at zero. (Ernst & Albers, 2017)\nHomoscedasticity: The errors are expected to have constant variance across all values of the predictors. If the spread of errors changes (heteroscedasticity), the assumption is violated. (Ernst & Albers, 2017)\nIndependence: Errors must be independent of each other, meaning their covariances are zero. This requires proper random sampling. Residual plots or autocorrelation checks help detect issues. (Ernst & Albers, 2017)"
  },
  {
    "objectID": "Handout.html#linear-model-or-lm-in-r",
    "href": "Handout.html#linear-model-or-lm-in-r",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "1.2 Linear Model or lm() in R",
    "text": "1.2 Linear Model or lm() in R\nThe Linear Model is is used to fit linear models, including multivariate ones. It can be used to carry out regression, single stratum analysis of variance and analysis of covariance. The basic sintax is the following:\nBasic Syntax\nmodel &lt;- lm(formula, data = dataset)"
  },
  {
    "objectID": "Handout.html#preparing-data-and-fitting-the-model-in-r",
    "href": "Handout.html#preparing-data-and-fitting-the-model-in-r",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "2.1 Preparing Data and Fitting the Model in R",
    "text": "2.1 Preparing Data and Fitting the Model in R\nR uses a concise formula syntax and the function lm() for linear models. Before fitting a model, it is good practice to inspect the data, check for missing values, and explore relationships. Below we use the built-in mtcars dataset to illustrate an MLR where miles per gallon (mpg) is predicted by weight (wt), horsepower (hp), and number of cylinders (cyl). This is a simple example similar in spirit to many introductory regression tutorials in R\n# Load data\ndata(mtcars)\n# Quick overview\nstr(mtcars)\nsummary(mtcars)\n# Correlation matrix for numerical variables\ncor(mtcars[, c(\"mpg\", \"wt\", \"hp\", \"cyl\")])\n# Simple scatterplot matrix\npairs(mtcars[, c(\"mpg\", \"wt\", \"hp\", \"cyl\")])\nOutput:\n\n\nRplot"
  },
  {
    "objectID": "Handout.html#fitting-a-multiple-linear-regression-with-lm",
    "href": "Handout.html#fitting-a-multiple-linear-regression-with-lm",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "2.2 Fitting a multiple linear regression with lm()",
    "text": "2.2 Fitting a multiple linear regression with lm()\n# Fit the model\nmodel &lt;- lm(mpg ~ wt + hp + cyl, data = mtcars)\n# Basic summary output\nsummary(model)\nOutput:\n\nEstimated coefficients (Estimate)\nStandard errors (Std. Error)\nt-values and p-values\nResidual standard error\nR^2 and adjusted R^2\nF-statistic for the overall model\n\nAt this stage, you have a working model, but it is not yet ready to report. Next you must check whether assumptions are reasonably satisfied."
  },
  {
    "objectID": "Handout.html#model-diagnostics-in-r",
    "href": "Handout.html#model-diagnostics-in-r",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "2.3 Model Diagnostics in R",
    "text": "2.3 Model Diagnostics in R\n\n2.3.1 Residual plots and normality\n# Basic diagnostic plots (4-panel layout)\npar(mfrow = c(2, 2))\nplot(model)\npar(mfrow = c(1, 1))\nOutput\n\n\nRplot01\n\n\n\nKey plots:\n\nResiduals vs Fitted – Should show a roughly random scatter (no strong curve or funnel pattern).\nNormal Q-Q – Points should follow the diagonal line if residuals are approximately normal.\nScale-Location – Checks homoscedasticity (constant spread of residuals).\nResiduals vs Leverage / Cook’s distance – Highlights influential observations.\n\n\n\n2.3.2 Checking multicollinearity with VIF\nMulticollinearity inflates standard errors and makes individual coefficients unstable even if the overall model is significant. The variance inflation factor (VIF) is a widely used measure; values above about 5–10 are often flagged as problematic.\n# install.packages(\"car\")  # run once if not installed\nlibrary(car)\nvif(model)\nIn this case the VIF for wt is 2.58, for hp is 3.26 and for cyl is 4.75"
  },
  {
    "objectID": "Handout.html#presenting-multiple-regression-results",
    "href": "Handout.html#presenting-multiple-regression-results",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "2.4 Presenting Multiple Regression Results",
    "text": "2.4 Presenting Multiple Regression Results\nThe broom package converts R’s model objects (like lm) into tidy data frames, making it easy to create tables and plots of results.\n# install.packages(\"broom\")  # run once\nlibrary(broom)\n# Coefficient-level information\ncoef_table &lt;- tidy(model, conf.int = TRUE)\ncoef_table\n# Model-level summary (R^2, etc.)\nmodel_fit &lt;- glance(model)\nmodel_fit"
  },
  {
    "objectID": "Handout.html#visualizing-and-communicating-predictions",
    "href": "Handout.html#visualizing-and-communicating-predictions",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "2.5 Visualizing and Communicating Predictions",
    "text": "2.5 Visualizing and Communicating Predictions\n# Predictions for the observed data\nmtcars$pred_mpg &lt;- predict(model)\n# Create a small new data set for scenario-based predictions\nnew_cars &lt;- data.frame(\n  wt  = c(2.5, 3.0, 3.5),  # in 1000 lb\n  hp  = c(100, 150, 200),\n  cyl = c(4, 6, 8)\n)\npredictions &lt;- predict(model, newdata = new_cars, interval = \"confidence\")\ncbind(new_cars, predictions)\n# install.packages(\"ggplot2\")  # run once\nlibrary(ggplot2)\nggplot(mtcars, aes(x = pred_mpg, y = mpg)) +\n  geom_point() +\n  geom_abline(intercept = 0, slope = 1, linetype = \"dashed\") +\n  labs(\n    x = \"Predicted MPG\",\n    y = \"Observed MPG\",\n    title = \"Observed vs Predicted Fuel Efficiency\"\n  )\nOutput:\n\n\nRplot02"
  },
  {
    "objectID": "Presentation.html#conducting-and-presenting-multiple-linear-regression-analysis-using-r",
    "href": "Presentation.html#conducting-and-presenting-multiple-linear-regression-analysis-using-r",
    "title": "Presentation",
    "section": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "text": "Conducting and Presenting Multiple Linear Regression Analysis Using R\nBy Maria Paula Rojas Conejo\nHandout (HTML website) https://mariarojas01.github.io/data-analysis\nHandout (PDF, A4 format) https://mariarojas01.github.io/data-analysis/Handout.pdf\nPresentation (HTML slideshow) https://mariarojas01.github.io/data-analysis/Presentation.html\nPresentation (PDF) https://mariarojas01.github.io/data-analysis/Presentation.pdfhttps://mariarojas01.github.io/data-analysis/Presentation.pdf"
  },
  {
    "objectID": "Presentation.html#what-is-multiple-linear-regression",
    "href": "Presentation.html#what-is-multiple-linear-regression",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "2 What is Multiple Linear Regression",
    "text": "2 What is Multiple Linear Regression\nRegression analysis is used to determine the relationships between two or more variables that exhibit cause–effect patterns, and to make predictions based on those relationships.\n\\[\nY_i = b_0 + b_1 X_{1i} + b_2 X_{2i} + \\dots + b_n X_{ni} + u_i\n\\]"
  },
  {
    "objectID": "Presentation.html#code",
    "href": "Presentation.html#code",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "Code",
    "text": "Code\nWhen you click the Render button a presentation will be generated that includes both content and the output of embedded code. You can embed code like this:\n\n\n[1] 2"
  },
  {
    "objectID": "Presentation.html#links",
    "href": "Presentation.html#links",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "",
    "text": "Handout (HTML website) https://mariarojas01.github.io/data-analysis\nPresentation (HTML slideshow) https://mariarojas01.github.io/data-analysis/Presentation.html\nPresentation (PDF) https://mariarojas01.github.io/data-analysis/Presentation.pdf"
  },
  {
    "objectID": "Presentation.html#steps-to-do-a-multiple-linear-regression-analysis",
    "href": "Presentation.html#steps-to-do-a-multiple-linear-regression-analysis",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "3 Steps to do a multiple linear regression analysis",
    "text": "3 Steps to do a multiple linear regression analysis\n\nDefine the research question\nPrepare and explore the data\nFit the initial model with lm()\nPerform diagnostics\nRefine the model if necessary\nSummarize results with broom or similar tools\nReport and interpret results"
  },
  {
    "objectID": "Presentation.html#preparing-data-and-fitting-the-model-in-r",
    "href": "Presentation.html#preparing-data-and-fitting-the-model-in-r",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "4 Preparing Data and Fitting the Model in R",
    "text": "4 Preparing Data and Fitting the Model in R\n# Load data\ndata(mtcars)\n# Quick overview\nstr(mtcars)\nsummary(mtcars)\n# Correlation matrix for numerical variables\ncor(mtcars[, c(\"mpg\", \"wt\", \"hp\", \"cyl\")])\n# Simple scatterplot matrix\npairs(mtcars[, c(\"mpg\", \"wt\", \"hp\", \"cyl\")])\n\nMiles per gallon (mpg) is predicted by weight (wt), horsepower (hp), and number of cylinders (cyl)."
  },
  {
    "objectID": "Presentation.html#hello",
    "href": "Presentation.html#hello",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "Hello",
    "text": "Hello\n\n\n'data.frame':   32 obs. of  11 variables:\n $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...\n $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...\n $ disp: num  160 160 108 258 360 ...\n $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...\n $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...\n $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...\n $ qsec: num  16.5 17 18.6 19.4 17 ...\n $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...\n $ am  : num  1 1 1 0 0 0 0 0 0 0 ...\n $ gear: num  4 4 4 3 3 3 3 4 4 4 ...\n $ carb: num  4 4 1 1 2 1 4 2 2 4 ...\n\n\n      mpg             cyl             disp             hp       \n Min.   :10.40   Min.   :4.000   Min.   : 71.1   Min.   : 52.0  \n 1st Qu.:15.43   1st Qu.:4.000   1st Qu.:120.8   1st Qu.: 96.5  \n Median :19.20   Median :6.000   Median :196.3   Median :123.0  \n Mean   :20.09   Mean   :6.188   Mean   :230.7   Mean   :146.7  \n 3rd Qu.:22.80   3rd Qu.:8.000   3rd Qu.:326.0   3rd Qu.:180.0  \n Max.   :33.90   Max.   :8.000   Max.   :472.0   Max.   :335.0  \n      drat             wt             qsec             vs        \n Min.   :2.760   Min.   :1.513   Min.   :14.50   Min.   :0.0000  \n 1st Qu.:3.080   1st Qu.:2.581   1st Qu.:16.89   1st Qu.:0.0000  \n Median :3.695   Median :3.325   Median :17.71   Median :0.0000  \n Mean   :3.597   Mean   :3.217   Mean   :17.85   Mean   :0.4375  \n 3rd Qu.:3.920   3rd Qu.:3.610   3rd Qu.:18.90   3rd Qu.:1.0000  \n Max.   :4.930   Max.   :5.424   Max.   :22.90   Max.   :1.0000  \n       am              gear            carb      \n Min.   :0.0000   Min.   :3.000   Min.   :1.000  \n 1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:2.000  \n Median :0.0000   Median :4.000   Median :2.000  \n Mean   :0.4062   Mean   :3.688   Mean   :2.812  \n 3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:4.000  \n Max.   :1.0000   Max.   :5.000   Max.   :8.000  \n\n\n           mpg         wt         hp        cyl\nmpg  1.0000000 -0.8676594 -0.7761684 -0.8521620\nwt  -0.8676594  1.0000000  0.6587479  0.7824958\nhp  -0.7761684  0.6587479  1.0000000  0.8324475\ncyl -0.8521620  0.7824958  0.8324475  1.0000000"
  },
  {
    "objectID": "Presentation.html#output",
    "href": "Presentation.html#output",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "5 Output",
    "text": "5 Output\n\n# Correlation matrix for numerical variables\ncor(mtcars[, c(\"mpg\", \"wt\", \"hp\", \"cyl\")])\n\n           mpg         wt         hp        cyl\nmpg  1.0000000 -0.8676594 -0.7761684 -0.8521620\nwt  -0.8676594  1.0000000  0.6587479  0.7824958\nhp  -0.7761684  0.6587479  1.0000000  0.8324475\ncyl -0.8521620  0.7824958  0.8324475  1.0000000\n\n# Simple scatterplot matrix\npairs(mtcars[, c(\"mpg\", \"wt\", \"hp\", \"cyl\")])"
  },
  {
    "objectID": "Presentation.html#fitting-a-multiple-linear-regression-with-lm",
    "href": "Presentation.html#fitting-a-multiple-linear-regression-with-lm",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "6 Fitting a multiple linear regression with lm()",
    "text": "6 Fitting a multiple linear regression with lm()\n# Fit the model\nmodel &lt;- lm(mpg ~ wt + hp + cyl, data = mtcars)\n# Basic summary output\nsummary(model)"
  },
  {
    "objectID": "Presentation.html#output-1",
    "href": "Presentation.html#output-1",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "7 Output",
    "text": "7 Output\n\n# Fit the model\nmodel &lt;- lm(mpg ~ wt + hp + cyl, data = mtcars)\n# Basic summary output\nsummary(model)\n\n\nCall:\nlm(formula = mpg ~ wt + hp + cyl, data = mtcars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.9290 -1.5598 -0.5311  1.1850  5.8986 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 38.75179    1.78686  21.687  &lt; 2e-16 ***\nwt          -3.16697    0.74058  -4.276 0.000199 ***\nhp          -0.01804    0.01188  -1.519 0.140015    \ncyl         -0.94162    0.55092  -1.709 0.098480 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.512 on 28 degrees of freedom\nMultiple R-squared:  0.8431,    Adjusted R-squared:  0.8263 \nF-statistic: 50.17 on 3 and 28 DF,  p-value: 2.184e-11"
  },
  {
    "objectID": "Presentation.html#model-diagnostics-in-r",
    "href": "Presentation.html#model-diagnostics-in-r",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "8 Model Diagnostics in R",
    "text": "8 Model Diagnostics in R\n# Basic diagnostic plots (4-panel layout)\npar(mfrow = c(2, 2))\nplot(model)\npar(mfrow = c(1, 1))\nOutput\n\n# Basic diagnostic plots (4-panel layout)\npar(mfrow = c(2, 2))\nplot(model)\n\n\n\n\n\n\n\npar(mfrow = c(1, 1))"
  },
  {
    "objectID": "Presentation.html#checking-multicollinearity-with-vif",
    "href": "Presentation.html#checking-multicollinearity-with-vif",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "9 Checking multicollinearity with VIF",
    "text": "9 Checking multicollinearity with VIF\n# install.packages(\"car\")  # run once if not installed\nlibrary(car)\nvif(model)\n\n9.1 Output\n\n# install.packages(\"car\")  # run once if not installed\nlibrary(car)\n\nLoading required package: carData\n\nvif(model)\n\n      wt       hp      cyl \n2.580486 3.258481 4.757456"
  },
  {
    "objectID": "Presentation.html#presenting-multiple-regression-results",
    "href": "Presentation.html#presenting-multiple-regression-results",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "10 Presenting Multiple Regression Results",
    "text": "10 Presenting Multiple Regression Results\nThe broom package converts R’s model objects into tidy data frames, making it easy to create tables and plots of results.\n# install.packages(\"broom\")  # run once\nlibrary(broom)\n# Coefficient-level information\ncoef_table &lt;- tidy(model, conf.int = TRUE)\ncoef_table\n# Model-level summary (R^2, etc.)\nmodel_fit &lt;- glance(model)\nmodel_fit"
  },
  {
    "objectID": "Presentation.html#output-3",
    "href": "Presentation.html#output-3",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "11 Output",
    "text": "11 Output\n\n# install.packages(\"broom\")  # run once\nlibrary(broom)\n# Coefficient-level information\ncoef_table &lt;- tidy(model, conf.int = TRUE)\ncoef_table\n\n# A tibble: 4 × 7\n  term        estimate std.error statistic  p.value conf.low conf.high\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)  38.8       1.79       21.7  4.80e-19  35.1     42.4    \n2 wt           -3.17      0.741      -4.28 1.99e- 4  -4.68    -1.65   \n3 hp           -0.0180    0.0119     -1.52 1.40e- 1  -0.0424   0.00629\n4 cyl          -0.942     0.551      -1.71 9.85e- 2  -2.07     0.187  \n\n# Model-level summary (R^2, etc.)\nmodel_fit &lt;- glance(model)\nmodel_fit\n\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC\n      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1     0.843         0.826  2.51      50.2 2.18e-11     3  -72.7  155.  163.\n# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;"
  },
  {
    "objectID": "Presentation.html#visualizing-and-communicating-predictions",
    "href": "Presentation.html#visualizing-and-communicating-predictions",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "12 Visualizing and Communicating Predictions",
    "text": "12 Visualizing and Communicating Predictions\n# Predictions for the observed data\nmtcars$pred_mpg &lt;- predict(model)\n# Create a small new data set for scenario-based predictions\nnew_cars &lt;- data.frame(\n  wt  = c(2.5, 3.0, 3.5),  # in 1000 lb\n  hp  = c(100, 150, 200),\n  cyl = c(4, 6, 8)\n)\npredictions &lt;- predict(model, newdata = new_cars, interval = \"confidence\")\ncbind(new_cars, predictions)\n# install.packages(\"ggplot2\")  # run once\nlibrary(ggplot2)\nggplot(mtcars, aes(x = pred_mpg, y = mpg)) +\n  geom_point() +\n  geom_abline(intercept = 0, slope = 1, linetype = \"dashed\") +\n  labs(\n    x = \"Predicted MPG\",\n    y = \"Observed MPG\",\n    title = \"Observed vs Predicted Fuel Efficiency\"\n  )"
  },
  {
    "objectID": "Presentation.html#output-4",
    "href": "Presentation.html#output-4",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "13 Output",
    "text": "13 Output\n\n# Predictions for the observed data\nmtcars$pred_mpg &lt;- predict(model)\n# Create a small new data set for scenario-based predictions\nnew_cars &lt;- data.frame(\n  wt  = c(2.5, 3.0, 3.5),  # in 1000 lb\n  hp  = c(100, 150, 200),\n  cyl = c(4, 6, 8)\n)\npredictions &lt;- predict(model, newdata = new_cars, interval = \"confidence\")\ncbind(new_cars, predictions)\n\n   wt  hp cyl      fit      lwr      upr\n1 2.5 100   4 25.26408 23.67315 26.85500\n2 3.0 150   6 20.89545 19.92960 21.86131\n3 3.5 200   8 16.52683 15.01760 18.03605\n\n# install.packages(\"ggplot2\")  # run once\nlibrary(ggplot2)\nggplot(mtcars, aes(x = pred_mpg, y = mpg)) +\n  geom_point() +\n  geom_abline(intercept = 0, slope = 1, linetype = \"dashed\") +\n  labs(\n    x = \"Predicted MPG\",\n    y = \"Observed MPG\",\n    title = \"Observed vs Predicted Fuel Efficiency\"\n  )"
  },
  {
    "objectID": "Presentation.html#exersise",
    "href": "Presentation.html#exersise",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "14 Exersise",
    "text": "14 Exersise"
  },
  {
    "objectID": "Presentation.html",
    "href": "Presentation.html",
    "title": "Conducting and Presenting Multiple Linear Regression Analysis Using R",
    "section": "",
    "text": "Handout (HTML website) https://mariarojas01.github.io/data-analysis\nPresentation (HTML slideshow) https://mariarojas01.github.io/data-analysis/Presentation.html\nPresentation (PDF) https://mariarojas01.github.io/data-analysis/Presentation.pdf"
  }
]